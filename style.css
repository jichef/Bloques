:root { 
  --ui-bg: #ffffffcc; 
  --strip-h: 44px;                 /* altura visible de la franja Detalles */
  --ff-fix: 0px;                   /* padding extra específico para Firefox */
}
* { box-sizing: border-box; }

html, body { 
  margin:0; 
  height:100%; 
  background:#f9f9f9; 
  font-family:system-ui,-apple-system,Segoe UI,Roboto,sans-serif; 
}

/* ===== Canvas / contenedor =====
   Reservamos la franja + área segura + fix Firefox para que no tape el lienzo */
#container { 
  position: fixed; 
  top: 0; 
  left: 0; 
  right: 0; 
  bottom: calc(var(--strip-h) + env(safe-area-inset-bottom, 0px) + var(--ff-fix));
}
/* Usa 100dvh cuando esté soportado para evitar “barras” móviles */
@supports (height: 100dvh) {
  #container {
    height: calc(100dvh - (var(--strip-h) + env(safe-area-inset-bottom, 0px) + var(--ff-fix)));
    top: 0; bottom: auto;
  }
}

/* ===== Fix específico para Firefox (detectado por -moz-appearance) ===== */
@supports (-moz-appearance: none) {
  :root { --ff-fix: 8px; }   /* si aún queda justo, sube a 10px o 12px */
}

/* ===== Fuente personalizada Escolar ===== */
@font-face {
  font-family: 'Escolar';
  src:
    url('escolar_G.woff2') format('woff2'),
    url('escolar_G.ttf') format('truetype');
  font-weight: 400;
  font-style: normal;
  font-display: swap;
}

/* ===== Franja superior (estado grande) ===== */
#status {
  font-family: 'Escolar', system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
  font-size: 20px;  
  line-height: 1.3;
  padding-top: 2px;
}

/* ===== Panel inferior (desplegable: contenido) ===== */
#breakdown {
  font-family: 'Escolar', system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
  font-size: 26px;       /* grande y legible */
  line-height: 1.5;
  display:grid; 
  grid-template-columns:auto 1fr; 
  gap:6px 12px;
}
#breakdown .label { color:#555; }
#breakdown .value { font-weight:600; }

/* ===== Colores de C, D y U (reutilizables) ===== */
.c { color:#2ecc71; font-weight:700; }  /* Centenas (verde)  */
.d { color:#ff3b30; font-weight:700; }  /* Decenas  (rojo)   */
.u { color:#1f78ff; font-weight:700; }  /* Unidades (azul)   */

/* ===== Franja inferior fija ("Detalles") =====
   Altura = strip + área segura + fix Firefox, para que nunca quede medio fuera. */
#details-strip{
  position: fixed;
  left: 0; right: 0; bottom: 0;
  height: calc(var(--strip-h) + env(safe-area-inset-bottom, 0px) + var(--ff-fix));
  padding: 0 14px;
  padding-bottom: calc(env(safe-area-inset-bottom, 0px) + var(--ff-fix));
  display: flex; align-items: center; gap: 10px;
  background: rgba(255,255,255,0.96);
  border-top: 1px solid #e5e5e5;
  font-family: 'Escolar', system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
  font-size: 18px;
  line-height: 1.3;
  color: #1f2340;
  z-index: 12;
  cursor: pointer;
  user-select: none;
}
#details-text{ overflow: hidden; text-overflow: ellipsis; white-space: nowrap; flex: 1 1 auto; }
#details-caret{ font-size: 12px; color: #636a8a; }

/* ===== Contenedor del panel plegable ===== */
#panel-wrap { position: fixed; left: 0; right: 0; bottom: 0; z-index: 20; }

/* ===== Panel (plegable) =====
   Cuando está “cerrado”, deja ver exactamente la franja de altura --strip-h */
#panel { 
  max-height: 40vh; 
  overflow: auto; 
  background: rgba(255,255,255,0.96);
  border-top: 1px solid #e5e5e5;
  padding: 10px 14px;
  transform: translateY(calc(100% - var(--strip-h)));
  transition: transform .25s ease;
  pointer-events: none;
}
#panel.open {
  transform: translateY(0%);
  pointer-events: auto;
}
#panel h3, #panel h4 { margin:8px 0; }
#panel #panel-toggle { pointer-events: auto; }

/* ===== Botones superiores ===== */
#controls {
  position: fixed;
  top: env(safe-area-inset-top, 8px);
  left: env(safe-area-inset-left, 8px);
  right: env(safe-area-inset-right, 8px);
  padding: 8px; z-index: 10; background: var(--ui-bg);
  backdrop-filter: blur(6px); border-radius: 12px;
  box-shadow: 0 6px 18px rgba(0,0,0,.12);
}
#controls .row { display:flex; flex-wrap:wrap; gap:8px; margin-bottom:6px; }
#controls button { font-size:16px; padding:10px 14px; border-radius:10px; border:none; background:#3498db; color:#fff; cursor:pointer; }
#controls button:hover { background:#2e86c1; }
#controls button:active { transform: translateY(1px); }

/* iOS: evitar zoom extraño al tocar botones */
button { touch-action: manipulation; }